(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();const o={SCRIPT_ID:"scrollingEffects",ROOT_MARGIN_TOP_DESKTOP:5,ROOT_MARGIN_BOT_DESKTOP:20,ROOT_MARGIN_TOP_MOBILE:20,ROOT_MARGIN_BOT_MOBILE:25,MOBILE_WIDTH_CUTOFF_PX:640,MOBILE_TOP_PADDING_VH:40,INTERSECTION_RATE:100,BLUR_STRENGTH_MAX:20,MECH_ROTATE_MAX:.2,MECH_PERSPECTIVE_AMT:40,MECH_SCALE_AMT:.5,BRIGHTNESS_MIN:2,BRIGHTNESS_MAX:1,VIGNETTE_EFFECT_ENABLE:!1,CAPTION_FADEIN_ENABLE:!1,CAPTION_FADEIN_THRESHOLD:.8,OBSERVER_RESET_WATCHER_INTERVAL:200,DEBUG:!1};function E(e){var t;return(t=e.shadowRoot)==null?void 0:t.querySelector(".media")}function f(e,{filter:t,transform:r}){const s=E(e);if(!s)return Error(`Vignette does not have a .media element!
`,e);s.style.filter=t,s.style.transform=r}function R(e){const t=`blur(${o.BLUR_STRENGTH_MAX}px) brightness(${o.BRIGHTNESS_MIN*100}%)`,r=`perspective(${o.MECH_PERSPECTIVE_AMT}vw) rotateX(${o.MECH_ROTATE_MAX}turn) scale(${o.MECH_SCALE_AMT}`;return f(e,{filter:t,transform:r})}function d(e,t){return e.documentElement.clientWidth<o.MOBILE_WIDTH_CUTOFF_PX}function _(e){const t=e.getElementsByTagName("media-item");return Object.values(t).sort()}function T(e,t){t.forEach(r=>{e.observe(r)})}function O(e){let t=!1;return r=>{const s=r==e;return!s&&!t?(t=!0,!1):!s||!t?!1:(t=!1,!0)}}async function m(){return new Promise((e,t)=>{let r=0;setTimeout(()=>{if(r++,window.store&&e(window.store),r==50)throw Error("Took too long to get store")},100)})}function g(e,t){let r=[];e.subscribe(()=>{const s=e.getState().frontendState.renderedPages;s!==r&&(s.filter(n=>!r.includes(n)).forEach(t),r=s)})}function u(e,t){e.disconnect();const r=_(t);T(e,r)}function M(e){const t=d(e),r=t?o.ROOT_MARGIN_TOP_MOBILE:o.ROOT_MARGIN_TOP_DESKTOP,s=t?o.ROOT_MARGIN_BOT_MOBILE:o.ROOT_MARGIN_BOT_DESKTOP,i={threshold:Array(o.INTERSECTION_RATE).fill(0).map((c,a)=>a/o.INTERSECTION_RATE),root:null,rootMargin:`-${r}% 0% -${s}% 0% `};return new IntersectionObserver(A,i)}function A(e){e.forEach(t);return;function t(r){const s=r.target;if(!E(s))return;const n=r.intersectionRatio,i=r.boundingClientRect.top<r.rootBounds.top,c=S(n),a=C(n,i),I=n.toString(),l=f(s,{filter:c,transform:a});l&&console.warn(l),r.target.style.opacity=I}}function S(e){const t=o.BLUR_STRENGTH_MAX-Math.round(e*o.BLUR_STRENGTH_MAX),r=e*(o.BRIGHTNESS_MAX-o.BRIGHTNESS_MIN)+o.BRIGHTNESS_MIN;return`blur(${t}px) brightness(${r*100}%)`}function C(e,t){if(e==1)return"";const r=o.MECH_PERSPECTIVE_AMT,s=o.MECH_ROTATE_MAX-e*o.MECH_ROTATE_MAX,n=t?s:-s,c=1-o.MECH_SCALE_AMT+e*o.MECH_SCALE_AMT;return`perspective(${r}vw) rotateX(${n}turn) scale(${c})  `}p();async function p(){console.log("Scrolling effects by @oxgr");const e=document.querySelector(`#${o.SCRIPT_ID}`);e||console.warn(`Script element could not be found!
Does the ID set on the element in Cargo match Params.SCRIPT_ID?

SCRIPT_ID: '${o.SCRIPT_ID}'

ID is required to track page element changes and reset IntersectionObserver reliably.
Proceeding with timer reset...`);const t=_(document),r=M(document);T(r,t),t.forEach((n,i)=>{i!=0&&R(n)});try{store=await m()}catch(n){console.error(n)}if(e&&store){g(store,n=>{n.querySelector(`#${o.SCRIPT_ID}`)&&u(r,document)});return}const s=O("/");setInterval(()=>{s(window.location.pathname)&&u(r,document)},o.OBSERVER_RESET_WATCHER_INTERVAL)}
